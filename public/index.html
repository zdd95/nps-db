<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NPS Survey Data</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="header-row">
            <h1>NPS Survey Data</h1>
            <button onclick="resetAllFilters()" class="reset-all-btn">Сбросить все</button>
        </div>
        
        <div class="form-row">
            <!-- Фильтр: Проект -->
            <div class="filter-group">
                <label for="projectsDropdown">Проект:</label>
                <div class="dropdown">
                    <input type="text"
                           id="projectsDropdown"
                           class="dropdown-input"
                           placeholder="Загрузка проектов..."
                           readonly
                           onclick="toggleProjectDropdown()">
                    <div class="dropdown-list" id="projectList">
                        <div class="search-container">
                            <input type="text"
                                id="projectSearch"
                                class="search-input"
                                placeholder="Поиск проекта..."
                                oninput="filterProjects()">
                        </div>
                        <div class="dropdown-options" id="projectOptions"></div>
                    </div>
                </div>
            </div>
            
            <!-- Фильтр: Домен -->
            <div class="filter-group">
                <label for="domainFilter">Домен:</label>
                <div class="dropdown">
                    <input type="text"
                           id="domainFilter"
                           class="dropdown-input"
                           placeholder="Выберите проект"
                           readonly
                           onclick="toggleDomainDropdown()">
                    <div class="dropdown-list" id="domainList">
                        <div class="search-container">
                            <input type="text"
                                id="domainSearch"
                                class="search-input"
                                placeholder="Поиск домена..."
                                oninput="filterDomains()">
                        </div>
                        <div class="dropdown-options" id="domainOptions"></div>
                    </div>
                </div>
            </div>
            
            <!-- Фильтр: Выберите ID кампании -->
            <div class="filter-group">
                <label for="campaignFilter">ID кампании:</label>
                <div class="dropdown">
                    <input type="text"
                           id="campaignFilter"
                           class="dropdown-input"
                           placeholder="Выберите домен"
                           readonly
                           onclick="toggleCampaignDropdown()">
                    <div class="dropdown-list" id="campaignList">
                        <div class="search-container">
                            <input type="text"
                                id="campaignSearch"
                                class="search-input"
                                placeholder="Поиск campaign..."
                                oninput="filterCampaigns()">
                        </div>
                        <div class="dropdown-options" id="campaignOptions">
                            <div class="checkbox-controls">
                                <button type="button" onclick="selectAllCampaigns()" class="select-all-btn">Выбрать все</button>
                                <button type="button" onclick="deselectAllCampaigns()" class="deselect-all-btn">Сбросить все</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Фильтр: Диапазон дат -->
            <div class="date-filters-inline">
                <div class="filter-group">
                    <label for="dateFromFilter">Дата с:</label>
                    <div class="date-input-wrapper">
                        <input type="date" id="dateFromFilter">
                    </div>
                </div>

                <div class="filter-group">
                    <label for="dateToFilter">Дата по:</label>
                    <div class="date-input-wrapper">
                        <input type="date" id="dateToFilter">
                    </div>
                </div>
            </div>
        </div>

        <div class="buttons-group">
            <button onclick="loadData()">Загрузить данные с БД</button>
            <button onclick="downloadCSV()" id="downloadBtn" disabled>Скачать CSV</button>
            <button onclick="openAnalysisModal()" id="analyzeBtn" disabled>Анализ данных</button>
        </div>
        
        <div id="message"></div>
        <div id="loading" class="loading" style="display: none;">Загрузка данных...</div>
        
        <div id="tableContainer" style="margin-top: 20px;"></div>
        <div id="paginationContainer" class="pagination" style="display: none;">
            <div class="pagination-left">
                <label for="pageSizeSelect">Показывать по:</label>
                <select id="pageSizeSelect">
                    <option value="25" selected>25</option>
                    <option value="50">50</option>
                    <option value="100">100</option>
                    <option value="200">200</option>
                </select>
                <span id="totalCount" class="total-count"></span>
            </div>
            <div class="pagination-right">
                <button id="firstPageBtn" class="page-btn" title="Первая">«</button>
                <button id="prevPageBtn" class="page-btn" title="Назад">‹</button>
                <span id="pageInfo" class="page-info">Страница 1 из 1</span>
                <button id="nextPageBtn" class="page-btn" title="Вперёд">›</button>
                <button id="lastPageBtn" class="page-btn" title="Последняя">»</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <div class="scroll-fab">
        <button id="scrollUpBtn" class="fab-btn" title="Наверх">▲</button>
        <button id="scrollDownBtn" class="fab-btn" title="Вниз">▼</button>
    </div>

    <!-- Analysis Modal -->
    <div id="analysisModal" class="modal-overlay" style="display: none;">
        <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="analysisTitle">
            <div class="modal-header">
                <h2 id="analysisTitle">Отчет анализа данных</h2>
                <button class="modal-close" id="analysisCloseBtn" aria-label="Закрыть">✕</button>
            </div>
            <div class="modal-body" id="analysisBody"></div>
            <div class="modal-footer">
                <button class="modal-action" id="analysisOkBtn">Закрыть</button>
            </div>
        </div>
    </div>
</body>
</html>
